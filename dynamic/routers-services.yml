http:
  routers:
    # === Redirection globale HTTP -> HTTPS (tous hôtes) ===
    http-catchall:
      entryPoints: [ web ]
      rule: HostRegexp(`{any:.+}`)
      middlewares: [ redirect-https ]
      service: noop

    traefik-dashboard:
      entryPoints: [ "websecure" ]
      rule: "Host(`traefik.fullstack-dev.com`)"
      service: "api@internal"
      tls:
        certResolver: "le"
      middlewares: [ "auth", "hsts" ]

    fullstack_wildcard:
      entryPoints: [ "websecure" ]
      rule: "HostRegexp(`{subdomain:.+}.fullstack-dev.com`)"
      service: "fullstack_wildcard"
      tls:
        certResolver: "le"
      middlewares: [ "gzip", "hsts" ]

  services:
    fullstack_wildcard:
      loadBalancer:
        passHostHeader: true         # ✅ conserve le Host original
        servers:
          - url: "http://192.168.8.143"   # ✅ URL de ton IIS interne (port 80 ou autre)

    # Service bidon pour la redirection HTTP->HTTPS
    noop:
      loadBalancer:
        servers:
          - url: "http://127.0.0.1"